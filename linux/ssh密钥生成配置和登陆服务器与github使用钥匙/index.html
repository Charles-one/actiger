<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>SSH密钥生成配置和登陆服务器与github使用钥匙 - 小新实验室</title>
  
  <meta name="description" content="1.生成SSH公钥私钥  进入文件夹中(注:所有&rdquo;#&ldquo;表示说明)  cd ~/.ssh/ # 其中-t rsa是指定rsa加密算法, -C &quot;asus&quot;是添加描述asus ssh-keygen -t rsa -C &quot;asus&quot;  # 说明: 默认是保存在/Users/你的用户名/.ssh/下, 如果你指定了名字则保存在当前路径下. # 指定的必须是文件且是绝对路径 # 在这里我已经在 ~/.ssh/中, 默认会保存在这里 Enter file in which to save the key (/Users/username(你的用户名)/.ssh/id_rsa): asus_rsa # 这里提示输入密码, 直接Enter表示不要密码 Enter passphrase (empty for no passphrase): # 与上面输入的密码保持一致, 如果上面没输入,这里也不要输入 Enter same passphrase again:   提示这些信息就表示生成成功  Your identification has been saved in /Users/username/.ssh/asus_rsa. Your public key has been saved in /Users/username/.">
  <meta name="author" content="">
  
  <link href="https://charles-one.github.io/xiaoxinLab/css/font.css" rel="stylesheet">
  <link href="https://charles-one.github.io/xiaoxinLab/css/atom-one-dark.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i" rel="stylesheet">
  <link href="https://charles-one.github.io/xiaoxinLab/css/style.css" rel="stylesheet">
  
  <link rel="apple-touch-icon" href="https://charles-one.github.io/xiaoxinLab/img/apple-touch-icon.png">
  <link rel="icon" href="https://charles-one.github.io/xiaoxinLab/img/favicon.ico">
  
  <meta name="generator" content="Hugo 0.54.0" />
  
  <link rel="alternate" type="application/atom+xml" href="https://charles-one.github.io/xiaoxinLab/index.xml" title="小新实验室">
  
</head>
<body class="single">
  <header class="header">
    
    <p class="title"><a href="https://charles-one.github.io/xiaoxinLab/">小新实验室</a></p>
    
    <button class="menu-toggle" type="button"></button>
    <nav class="menu">
      <ul>
        
        
      </ul>
    </nav>
  </header>
  <main class="main">

<article class="post post-view">
  <header class="post-header">
    <h1 class="post-title">SSH密钥生成配置和登陆服务器与github使用钥匙</h1>
    <p class="post-meta">2019.3.30</p>
  </header>
  <div class="post-content">

<h3 id="1-生成ssh公钥私钥">1.生成SSH公钥私钥</h3>

<ul>
<li>进入文件夹中(注:所有&rdquo;#&ldquo;表示说明)</li>
</ul>

<pre><code>cd ~/.ssh/

# 其中-t rsa是指定rsa加密算法, -C &quot;asus&quot;是添加描述asus

ssh-keygen -t rsa -C &quot;asus&quot;
</code></pre>

<pre><code># 说明: 默认是保存在/Users/你的用户名/.ssh/下, 如果你指定了名字则保存在当前路径下.
# 指定的必须是文件且是绝对路径
# 在这里我已经在 ~/.ssh/中, 默认会保存在这里
Enter file in which to save the key (/Users/username(你的用户名)/.ssh/id_rsa): asus_rsa


# 这里提示输入密码, 直接Enter表示不要密码

Enter passphrase (empty for no passphrase):

# 与上面输入的密码保持一致, 如果上面没输入,这里也不要输入

Enter same passphrase again:

</code></pre>

<ul>
<li>提示这些信息就表示生成成功</li>
</ul>

<pre><code>Your identification has been saved in /Users/username/.ssh/asus_rsa.
Your public key has been saved in /Users/username/.ssh/asus_rsa.pub.
The key fingerprint is:
SHA256:WNwJoo/Rr0TvpnQIdA4YisZrF+7ZM8lKNB4JLpJXALA asus
The key's randomart image is:
+---[RSA 2048]----+
|+.o   . .        |
|oo + o o o .     |
|E+..* + o o      |
|o.+ooO =         |
|++.Bo = S        |
|+.= *o.+         |
|   = *+ +        |
|  . ..o+         |
|   .  .          |
+----[SHA256]-----+
</code></pre>

<ul>
<li>查看生成的文件asus_rsa密钥, asus_rsa.pub公钥</li>
</ul>

<pre><code>ls ~/.ssh/
</code></pre>

<h3 id="2-配置服务器公钥-可以远程登录">2.配置服务器公钥, 可以远程登录</h3>

<ul>
<li>上传公钥到服务器中, windows下xshell,mac 终端terminal</li>
</ul>

<pre><code># -i指定公钥文件, -p指定服务器端口

ssh-copy-id -i local_centos7_rsa.pub jenkins@10.211.55.9 -p 22

</code></pre>

<h5 id="输入用户密码就可以输入成功了-显示成功的信息">输入用户密码就可以输入成功了, 显示成功的信息</h5>

<p>Number of key(s) added:        1</p>

<p>Now try logging into the machine, with:   &ldquo;ssh -p &lsquo;22&rsquo; &lsquo;jenkins@10.211.55.9&rsquo;&rdquo;
and check to make sure that only the key(s) you wanted were added.</p>

<ul>
<li>添加配置</li>
</ul>

<pre><code>vim ~/.ssh/config
</code></pre>

<h5 id="添加如下配置-host表示主机别名-user是登录的用户名-hostname表示服务器ip地址或网址-preferredauthentications首先认证方式-identityfile私钥文件路径-port服务器端口">添加如下配置, Host表示主机别名, User是登录的用户名, HostName表示服务器ip地址或网址, PreferredAuthentications首先认证方式,IdentityFile私钥文件路径, Port服务器端口</h5>

<p><strong>多个用户时Host设置必须唯一, 禁止设置为ip地址</strong></p>

<pre><code>Host locale_centos7
 User jenkins
 HostName 10.211.55.9
 PreferredAuthentications publickey
 IdentityFile ~/.ssh/local_centos7_rsa
 Port 22
</code></pre>

<ul>
<li>尝试登陆服务器</li>
</ul>

<pre><code>ssh locale_centos7
</code></pre>

<h5 id="却提示公钥的权限不安全">却提示公钥的权限不安全</h5>

<p>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for &lsquo;/Users/username/.ssh/local_centos7_rsa.pub&rsquo; are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key &ldquo;/Users/username/.ssh/local_centos7_rsa.pub&rdquo;: bad permissions
jenkins@10.211.55.9: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).</p>

<ul>
<li>更改~/.ssh/local_centos7_rsa.pub文件权限</li>
</ul>

<pre><code>chmod 400 ~/.ssh/local_centos7_rsa.pub
</code></pre>

<ul>
<li>再次尝试登陆即是正常(ssh -v locale_centos7中-v会打印连接日志)</li>
</ul>

<pre><code>ssh locale_centos7
</code></pre>

<h3 id="3-github使用ssh公钥">3.github使用ssh公钥</h3>

<ul>
<li><p>复制公钥信息~/.ssh/local_centos7_rsa.pub 存入github keys设置中</p></li>

<li><p>增加配置文件~/.ssh/config</p></li>
</ul>

<p><strong>这个Host的别名,要有一个github.com, github默认ssh名字是github.com, 为了方便使用</strong></p>

<pre><code>Host github.com
 User git
 HostName github.com
 PreferredAuthentications publickey
 IdentityFile ~/.ssh/local_centos7_rsa
</code></pre>

<ul>
<li>测试和拉取公共类型的github代码</li>
</ul>

<pre><code>ssh -T git@github.com

git clone git@github.com:Charles-one/xiaoxinLab.git
</code></pre>

<ul>
<li>如果还有一个用户再有一个github用户</li>
</ul>

<p>添加配置./.ssh/config</p>

<pre><code>Host work.github.com
 User git
 HostName github.com
 PreferredAuthentications publickey
 IdentityFile ~/.ssh/wrok_rsa
</code></pre>

<h4 id="测试和拉取公共类型的github代码就变成">测试和拉取公共类型的github代码就变成</h4>

<h4 id="对比下-host默认github-com使用方便">对比下, Host默认github.com使用方便</h4>

<pre><code>ssh -T git@work.github.com

git clone git@work.github.com:Charles-one/xiaoxinLab.git
</code></pre>
</div>
  <footer class="post-footer">
    
  </footer>
  
  
  
  
</article>
</main>
<footer class="footer">
  <span>&copy; 2019 小新实验室</span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>️</span>
  <span>&middot;</span>
  <span>Designed by <a href="http://21beats.com/" rel="noopener" target="_blank">️21beats️</a>️</span>
</footer>
<script src="https://charles-one.github.io/xiaoxinLab/js/instantclick.min.js" data-no-instant></script>
<script data-no-instant>InstantClick.init();</script>
<script src="https://charles-one.github.io/xiaoxinLab/js/highlight.min.js" data-no-instant></script>
<script data-no-instant>
  addMenuListener();
  InstantClick.on('change', function() {
    addMenuListener();
  });
  function addMenuListener() {
    var $toggle = document.querySelector('.menu-toggle');
    var $body = document.querySelector('body');
    $toggle.addEventListener('click', function() {
      $body.classList.toggle('noscroll');
    }, false);
  }
</script>
</body>
</html>

